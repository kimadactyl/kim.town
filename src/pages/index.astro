---
import BaseLayout from "../layouts/BaseLayout.astro";
import { SITE_BASE, SocialLinks } from "../consts";
import { Icon } from "astro-icon/components";
import BlogCard from "../components/BlogCard.astro";
import WorkCard from "../components/WorkCard.astro";
import { getCollection } from "astro:content";
import { Image } from "astro:assets";
import kimPortrait from "../assets/kim-portrait.jpeg";

const posts = (await getCollection("writing"))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 6);

const works = (await getCollection("work"))
  .sort((a, b) => b.data.year - a.data.year)
  .slice(0, 3);
---

<BaseLayout>
  <main
    class="app-container grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-16 items-center py-36 md:py-48 pt-44 md:pt-56 relative"
  >
    <div class="flex flex-col gap-8">
      <div>
        <p class="block text-3xl opacity-70 mt-9 mb-4">Welcome to</p>
        <h1 class="text-8xl font-bold leading-none">Kim Town</h1>
      </div>
      <p class="text-2xl max-w-2xl font-light leading-normal">
        Dr Kim Foale's personal archive. Writing and work on technology, sound,
        games, and social change.
      </p>
      <div class="flex flex-wrap gap-8">
        {
          SocialLinks.map((link) => (
            <a
              class="text-xl text-primary dark:text-primary-dark underline hover:underline underline-offset-4"
              href={link.url}
              target="_blank"
            >
              {link.name}
            </a>
          ))
        }
      </div>
    </div>
    <div class="flex justify-center lg:justify-end">
      <Image
        src={kimPortrait}
        alt="Kim Foale"
        width={800}
        height={800}
        class="rounded-full w-64 h-64 md:w-80 md:h-80 lg:w-96 lg:h-96 object-cover object-[center_20%] -scale-x-100 sepia-[.15] saturate-[.9] hue-rotate-[340deg] contrast-[1.05]"
      />
    </div>
  </main>

  <!-- Recent Work Section -->
  <section class="app-container pb-16">
    <h2 class="section-title">Recent Work</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      {works.map((work) => <WorkCard work={work} />)}
    </div>
    <a class="btn-secondary" href={`${SITE_BASE}/work`}
      >View All Work
      <Icon size={20} name="mdi:arrow-right" />
    </a>
  </section>

  <!-- Recent Writing Section -->
  <section class="app-container">
    <h2 class="section-title">Recent Writing</h2>
    <div class="posts-grid-container">
      {posts.map((post) => <BlogCard post={post} />)}
    </div>
    <a class="btn-secondary" href={`${SITE_BASE}/writing`}
      >Read All Writing
      <Icon size={20} name="mdi:arrow-right" />
    </a>
  </section>

  <!-- About Section -->
  <section class="app-container py-42 grid lg:grid-cols-2 gap-28 lg:gap-10">
    <div class="space-y-6">
      <h2 class="section-title">About Me</h2>
      <p class="text-lg max-w-xl pb-4">
        I'm Kim Foale, a technologist, sound artist, and community organiser
        based in Manchester.
      </p>
      <a class="btn-secondary" href={`${SITE_BASE}/about`}
        >Go to About
        <Icon size={20} name="mdi:arrow-right" />
      </a>
    </div>
    <div class="space-y-6">
      <h2 class="section-title">Get in touch</h2>
      <p class="text-lg max-w-xl">
        Find me on social media or get in touch via email.
      </p>
      <div class="flex flex-wrap mt-auto space-x-4">
        <a class="btn-primary" href="mailto:kim@gfsc.studio" target="_blank"
          >Get in touch
          <Icon height={20} name="mdi:email" />
        </a>
      </div>
    </div>
  </section>
</BaseLayout>
